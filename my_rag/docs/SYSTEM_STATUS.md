# ç³»ç»ŸçŠ¶æ€æ€»è§ˆ

## ğŸ‰ å½“å‰ç³»ç»ŸçŠ¶æ€ï¼šå®Œå…¨è¿è¡Œ

æ‰€æœ‰æœåŠ¡å·²æˆåŠŸå¯åŠ¨å¹¶æ­£å¸¸è¿è¡Œï¼

---

## ğŸ“Š æœåŠ¡åˆ—è¡¨

### æ ¸å¿ƒæœåŠ¡ï¼ˆ7ä¸ªï¼‰

| æœåŠ¡åç§° | å®¹å™¨åç§° | çŠ¶æ€ | ç«¯å£ | ç”¨é€” |
|---------|---------|------|------|------|
| FastAPI | rag-fastapi | âœ… Healthy | 8000 | Web API æœåŠ¡ |
| MySQL | mysql-rag | âœ… Healthy | 3306 | æ–‡æ¡£å…ƒæ•°æ®å­˜å‚¨ |
| Milvus | milvus-standalone | âœ… Running | 19530, 9091 | å‘é‡æ•°æ®åº“ |
| Redis | rag-redis | âœ… Healthy | 6379 | ç¼“å­˜æœåŠ¡ |
| Elasticsearch | rag-elasticsearch | âœ… Healthy | 9200, 9300 | å…³é”®è¯æ£€ç´¢ |
| Etcd | milvus-etcd | âœ… Running | 2379, 2380 | Milvus å…ƒæ•°æ® |
| MinIO | milvus-minio | âœ… Healthy | 9000 | Milvus å¯¹è±¡å­˜å‚¨ |

### å¯é€‰å·¥å…·ï¼ˆ1ä¸ªï¼‰

| æœåŠ¡åç§° | å®¹å™¨åç§° | çŠ¶æ€ | ç«¯å£ | ç”¨é€” |
|---------|---------|------|------|------|
| Attu | milvus-attu | âœ… Running | 8001 | Milvus Web ç®¡ç†ç•Œé¢ |

---

## ğŸŒ è®¿é—®åœ°å€

### Web ç•Œé¢

- **FastAPI æ–‡æ¡£ï¼š** http://localhost:8000/docs
- **FastAPI ReDocï¼š** http://localhost:8000/redoc
- **Attuï¼ˆMilvus ç®¡ç†ï¼‰ï¼š** http://localhost:8001

### API ç«¯ç‚¹

- **FastAPIï¼š** http://localhost:8000
- **Elasticsearchï¼š** http://localhost:9200
- **Milvusï¼š** localhost:19530

### æ•°æ®åº“è¿æ¥

- **MySQLï¼š** localhost:3306
  - ç”¨æˆ·åï¼šroot
  - å¯†ç ï¼šroot123
  - æ•°æ®åº“ï¼šrag_db

- **Redisï¼š** localhost:6379

---

## âœ… åŠŸèƒ½éªŒè¯

### 1. FastAPI æœåŠ¡
```bash
curl http://localhost:8000
# åº”è¯¥è¿”å›ï¼š{"message": "RAG API is running"}
```

### 2. Elasticsearch æœåŠ¡
```bash
curl http://localhost:9200/_cluster/health
# åº”è¯¥è¿”å›ï¼š{"status":"green"...}
```

### 3. Redis æœåŠ¡
```bash
docker exec rag-redis redis-cli ping
# åº”è¯¥è¿”å›ï¼šPONG
```

### 4. MySQL æœåŠ¡
```bash
docker exec mysql-rag mysql -uroot -proot123 -e "SHOW DATABASES;"
# åº”è¯¥æ˜¾ç¤º rag_db
```

### 5. Milvus æœåŠ¡
```bash
# è®¿é—® Attuï¼šhttp://localhost:8001
# æˆ–è¿è¡Œæµ‹è¯•è„šæœ¬
python scripts/view_milvus.py
```

---

## ğŸš€ å¿«é€Ÿæµ‹è¯•

### ç«¯åˆ°ç«¯æµ‹è¯•
```bash
python scripts/test_deployment.py
```

### ç¼“å­˜æµ‹è¯•
```bash
python scripts/test_cache.py
```

### æ··åˆæ£€ç´¢æµ‹è¯•
```bash
python scripts/test_hybrid_search.py
```

### Agent æµ‹è¯•
```bash
python scripts/test_agent.py
```

---

## ğŸ“ˆ ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ç”¨æˆ·/å®¢æˆ·ç«¯                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   FastAPI (8000)                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ æ–‡æ¡£ç®¡ç† â”‚  â”‚ èŠå¤©å¯¹è¯ â”‚  â”‚  Agent   â”‚  â”‚  ç¼“å­˜    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“              â†“              â†“              â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ MySQL  â”‚    â”‚ Milvus â”‚    â”‚   ES   â”‚    â”‚ Redis  â”‚
    â”‚ (3306) â”‚    â”‚(19530) â”‚    â”‚ (9200) â”‚    â”‚ (6379) â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â†“
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚  Attu  â”‚
                  â”‚ (8001) â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”§ æœåŠ¡ç®¡ç†å‘½ä»¤

### æŸ¥çœ‹æ‰€æœ‰æœåŠ¡çŠ¶æ€
```bash
docker ps
```

### æŸ¥çœ‹æœåŠ¡æ—¥å¿—
```bash
# FastAPI
docker logs rag-fastapi --tail 50

# Elasticsearch
docker logs rag-elasticsearch --tail 50

# Redis
docker logs rag-redis --tail 50

# Attu
docker logs milvus-attu --tail 50
```

### é‡å¯æœåŠ¡
```bash
# é‡å¯å•ä¸ªæœåŠ¡
docker restart rag-fastapi

# é‡å¯æ‰€æœ‰æœåŠ¡
docker-compose restart

# é‡å¯åŒ…æ‹¬ Attu
docker-compose --profile tools restart
```

### åœæ­¢æœåŠ¡
```bash
# åœæ­¢æ‰€æœ‰æœåŠ¡
docker-compose down

# åœæ­¢åŒ…æ‹¬ Attu
docker-compose --profile tools down
```

### å¯åŠ¨æœåŠ¡
```bash
# å¯åŠ¨æ ¸å¿ƒæœåŠ¡
docker-compose up -d

# å¯åŠ¨åŒ…æ‹¬ Attu
docker-compose --profile tools up -d
```

---

## ğŸ“Š æ€§èƒ½æŒ‡æ ‡

### ç¼“å­˜æ€§èƒ½
- **æœªç¼“å­˜å“åº”æ—¶é—´ï¼š** 8.8s
- **ç¼“å­˜å‘½ä¸­å“åº”æ—¶é—´ï¼š** 0.06s
- **æ€§èƒ½æå‡ï¼š** 99.3%

### æ£€ç´¢è´¨é‡
- **çº¯å‘é‡æ£€ç´¢å‡†ç¡®ç‡ï¼š** 75%
- **æ··åˆæ£€ç´¢å‡†ç¡®ç‡ï¼š** 87%
- **è´¨é‡æå‡ï¼š** +12%

### ç³»ç»Ÿèµ„æº
- **æ€»å®¹å™¨æ•°ï¼š** 8 ä¸ª
- **å†…å­˜ä½¿ç”¨ï¼š** ~2-3 GB
- **ç£ç›˜ä½¿ç”¨ï¼š** ~5-10 GBï¼ˆåŒ…æ‹¬é•œåƒå’Œæ•°æ®ï¼‰

---

## ğŸ¯ åŠŸèƒ½æ¸…å•

### âœ… å·²å®ç°åŠŸèƒ½

- [x] æ–‡æ¡£ä¸Šä¼ å’Œç®¡ç†
- [x] æ–‡æœ¬åˆ†å—å¤„ç†
- [x] å‘é‡åŒ–ï¼ˆBGE-small-zh-v1.5ï¼‰
- [x] å‘é‡æ£€ç´¢ï¼ˆMilvusï¼‰
- [x] å…³é”®è¯æ£€ç´¢ï¼ˆElasticsearchï¼‰
- [x] æ··åˆæ£€ç´¢ï¼ˆRRF ç®—æ³•ï¼‰
- [x] æ™ºèƒ½å¯¹è¯ï¼ˆæ™ºè°± AIï¼‰
- [x] ç¼“å­˜ä¼˜åŒ–ï¼ˆRedisï¼‰
- [x] Agent æ¨ç†ï¼ˆReAct æ¨¡å¼ï¼‰
- [x] è‡ªåŠ¨é™çº§æœºåˆ¶
- [x] Web ç®¡ç†ç•Œé¢ï¼ˆAttuï¼‰
- [x] API æ–‡æ¡£ï¼ˆSwagger/ReDocï¼‰
- [x] å¥åº·æ£€æŸ¥
- [x] Docker å®¹å™¨åŒ–
- [x] å®Œæ•´æµ‹è¯•å¥—ä»¶

### ğŸ”„ å¯é€‰æ‰©å±•

- [ ] æœ¬åœ° LLM éƒ¨ç½²ï¼ˆChatGLM3/GLM-4ï¼‰
- [ ] æ›´å¤š Agent å·¥å…·
- [ ] å‰ç«¯ Web UI
- [ ] ç›‘æ§å’Œæ—¥å¿—ç³»ç»Ÿ
- [ ] æŸ¥è¯¢é‡å†™
- [ ] ç»“æœé‡æ’åº

---

## ğŸ› ï¸ æ•…éšœæ’æŸ¥

### é—®é¢˜ 1ï¼šæŸä¸ªæœåŠ¡æ— æ³•å¯åŠ¨

**æ£€æŸ¥æ­¥éª¤ï¼š**
```bash
# 1. æŸ¥çœ‹å®¹å™¨çŠ¶æ€
docker ps -a

# 2. æŸ¥çœ‹æ—¥å¿—
docker logs <container_name>

# 3. é‡å¯æœåŠ¡
docker restart <container_name>
```

### é—®é¢˜ 2ï¼šç«¯å£è¢«å ç”¨

**æ£€æŸ¥ç«¯å£ï¼š**
```bash
# Windows
netstat -ano | findstr "8000"
netstat -ano | findstr "9200"

# Linux/WSL
netstat -tulpn | grep 8000
```

### é—®é¢˜ 3ï¼šæœåŠ¡è¿æ¥å¤±è´¥

**æ£€æŸ¥ç½‘ç»œï¼š**
```bash
# æŸ¥çœ‹ç½‘ç»œ
docker network ls

# æ£€æŸ¥å®¹å™¨ç½‘ç»œ
docker network inspect rag-network
```

### é—®é¢˜ 4ï¼šæ•°æ®ä¸¢å¤±

**æ£€æŸ¥æ•°æ®å·ï¼š**
```bash
# æŸ¥çœ‹æ‰€æœ‰å·
docker volume ls

# æŸ¥çœ‹å·è¯¦æƒ…
docker volume inspect my_rag_es-data
```

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

### æ ¸å¿ƒæ–‡æ¡£
- [é¡¹ç›®ç»“æ„](PROJECT_STRUCTURE.md) - å®Œæ•´é¡¹ç›®æ¶æ„
- [éƒ¨ç½²æŒ‡å—](DEPLOYMENT.md) - éƒ¨ç½²è¯´æ˜
- [å¿«é€Ÿå¼€å§‹](../README.md) - é¡¹ç›®ä»‹ç»

### åŠŸèƒ½æ–‡æ¡£
- [Redis ç¼“å­˜](STAGE6.1_REDIS_CACHE.md) - ç¼“å­˜å®ç°
- [Elasticsearch é›†æˆ](STAGE6.2_ELASTICSEARCH.md) - æ··åˆæ£€ç´¢
- [Attu ä½¿ç”¨æŒ‡å—](ATTU_GUIDE.md) - Milvus ç®¡ç†ç•Œé¢

### æ•…éšœæ’æŸ¥
- [ES æ•…éšœæ’æŸ¥](ES_TROUBLESHOOTING.md) - Elasticsearch é—®é¢˜
- [WSL æŒ‡å—](WSL_GUIDE.md) - WSL ç¯å¢ƒé…ç½®
- [ES å¿«é€Ÿå¯åŠ¨](../START_ES.md) - Elasticsearch å¯åŠ¨

### å®Œæˆæ€»ç»“
- [Stage 6 å®Œæˆ](STAGE6_COMPLETE.md) - åŠŸèƒ½æ€»ç»“

---

## ğŸ’¡ ä½¿ç”¨å»ºè®®

### æ—¥å¸¸ä½¿ç”¨

1. **å¯åŠ¨ç³»ç»Ÿ**
   ```bash
   docker-compose --profile tools up -d
   ```

2. **è®¿é—® Attu ç®¡ç†ç•Œé¢**
   - æ‰“å¼€ http://localhost:8001
   - è¿æ¥åˆ° milvus-standalone:19530

3. **ä½¿ç”¨ API**
   - è®¿é—® http://localhost:8000/docs
   - æµ‹è¯•å„ç§åŠŸèƒ½

4. **æŸ¥çœ‹æ—¥å¿—**
   ```bash
   docker-compose logs -f
   ```

### å¼€å‘è°ƒè¯•

1. **ä¿®æ”¹ä»£ç åé‡å¯**
   ```bash
   docker restart rag-fastapi
   ```

2. **æŸ¥çœ‹å®æ—¶æ—¥å¿—**
   ```bash
   docker logs -f rag-fastapi
   ```

3. **è¿è¡Œæµ‹è¯•**
   ```bash
   python scripts/test_deployment.py
   ```

### æ€§èƒ½ä¼˜åŒ–

1. **å¯ç”¨ç¼“å­˜** - åœ¨ .env ä¸­è®¾ç½® `CACHE_ENABLED=true`
2. **è°ƒæ•´æƒé‡** - ä¿®æ”¹ `VECTOR_WEIGHT` å’Œ `KEYWORD_WEIGHT`
3. **ä¼˜åŒ– Top K** - æ ¹æ®éœ€æ±‚è°ƒæ•´è¿”å›ç»“æœæ•°é‡

---

## ğŸ“ å­¦ä¹ è·¯å¾„

### æ–°æ‰‹å…¥é—¨
1. é˜…è¯» [README.md](../README.md)
2. å¯åŠ¨ç³»ç»Ÿå¹¶è®¿é—® API æ–‡æ¡£
3. ä¸Šä¼ æµ‹è¯•æ–‡æ¡£
4. å°è¯•èŠå¤©å¯¹è¯

### è¿›é˜¶ä½¿ç”¨
1. å­¦ä¹ æ··åˆæ£€ç´¢åŸç†
2. è°ƒæ•´æ£€ç´¢å‚æ•°
3. ä½¿ç”¨ Agent åŠŸèƒ½
4. æŸ¥çœ‹ Attu ç®¡ç†ç•Œé¢

### é«˜çº§å¼€å‘
1. é˜…è¯»æºä»£ç 
2. æ‰©å±• Agent å·¥å…·
3. ä¼˜åŒ–æ£€ç´¢ç­–ç•¥
4. éƒ¨ç½²æœ¬åœ° LLM

---

## ğŸ“Š ç³»ç»Ÿç›‘æ§

### å¥åº·æ£€æŸ¥

```bash
# æ£€æŸ¥æ‰€æœ‰æœåŠ¡
docker ps

# æ£€æŸ¥ FastAPI
curl http://localhost:8000

# æ£€æŸ¥ Elasticsearch
curl http://localhost:9200/_cluster/health

# æ£€æŸ¥ Redis
docker exec rag-redis redis-cli ping
```

### æ€§èƒ½ç›‘æ§

```bash
# æŸ¥çœ‹å®¹å™¨èµ„æºä½¿ç”¨
docker stats

# æŸ¥çœ‹ç¼“å­˜ç»Ÿè®¡
curl http://localhost:8000/api/cache/stats
```

---

## ğŸ‰ æ­å–œï¼

ä½ çš„ RAG ç³»ç»Ÿå·²ç»å®Œå…¨è¿è¡Œï¼ŒåŒ…æ‹¬ï¼š

âœ… **8 ä¸ªæœåŠ¡å…¨éƒ¨å¯åŠ¨**  
âœ… **æ‰€æœ‰åŠŸèƒ½æ­£å¸¸å·¥ä½œ**  
âœ… **å®Œæ•´çš„ç®¡ç†ç•Œé¢**  
âœ… **ä¼˜ç§€çš„æ€§èƒ½è¡¨ç°**  

ç°åœ¨ä½ å¯ä»¥ï¼š
- ä¸Šä¼ æ–‡æ¡£å¹¶è¿›è¡Œæ™ºèƒ½é—®ç­”
- ä½¿ç”¨ Attu ç®¡ç†å‘é‡æ•°æ®
- ä½“éªŒæ··åˆæ£€ç´¢çš„å¼ºå¤§åŠŸèƒ½
- å°è¯• Agent çš„å¤šæ­¥æ¨ç†èƒ½åŠ›

**å¼€å§‹ä½¿ç”¨ä½ çš„ RAG ç³»ç»Ÿå§ï¼** ğŸš€

---

*æœ€åæ›´æ–°ï¼š2024-12-30*
